{"version":3,"file":"index.js","sources":["../../src/index.js"],"sourcesContent":["import { createElement } from 'react';\nimport { matchPath, withRouter } from 'react-router';\n\nconst DEFAULT_MATCH_OPTIONS = { exact: true };\n\n// if user is passing a function (component) as a breadcrumb, make sure we\n// pass the match object into it. Else just return the string.\nconst renderer = ({ breadcrumb, match }) => {\n  if (typeof breadcrumb === 'function') {\n    return createElement(breadcrumb, { match });\n  }\n  return breadcrumb;\n};\n\nexport const getBreadcrumbs = ({ routes, pathname }) => {\n  const matches = [];\n  const segments = [];\n\n  // remove trailing slash \"/\" from pathname unless it's a base route (avoids multiple of the same match)\n  let newPath = pathname.length > 1 ? pathname.replace(/\\/$/, '') : pathname;\n\n  while(newPath.length) {\n    // check whether next segment is a url fragment\n    if (newPath.startsWith('http')) {\n      segments.push(newPath);\n      newPath = '';\n    } else {\n      // grab next segment\n      const part = newPath.split('/', 1)[0];\n      segments.push(part);\n\n      // remove segment + slash from path\n      newPath = newPath.substr(part.length + 1);\n    }\n  }\n\n  segments\n    // reduce over the sections and find matches from `routes` prop\n    .reduce((previous, current) => {\n      // combine the last route section with the current\n      // ex `pathname = /1/2/3 results in match checks for\n      // `/1`, `/1/2`, `/1/2/3`\n      const pathSection = !current ? '/' : `${previous}/${current}`;\n\n      let breadcrumbMatch;\n\n      routes.some(({ breadcrumb, matchOptions, path }) => {\n        if (typeof breadcrumb === 'undefined' || !path) {\n          throw new Error('withBreadcrumbs: `breadcrumb` and `path` must be provided in every route object');\n        }\n\n        // allow omitting via falsy parameter\n        if (!breadcrumb) {\n          return false;\n        }\n\n        const match = matchPath(pathSection, { ...(matchOptions || DEFAULT_MATCH_OPTIONS), path });\n\n        // if a route match is found ^ break out of the loop with a rendered breadcumb\n        // and match object to add to the `matches` array\n        if (match) {\n          breadcrumbMatch = {\n            breadcrumb: renderer({ breadcrumb, match }),\n            path,\n            match,\n          };\n          return true;\n        }\n\n        return false;\n      });\n\n      /* istanbul ignore else */\n      if (breadcrumbMatch) {\n        matches.push(breadcrumbMatch);\n      }\n\n      return pathSection === '/' ? '' : pathSection;\n    }, null);\n\n  return matches;\n};\n\nexport const withBreadcrumbs = routes => Component => withRouter(props =>\n  createElement(Component, {\n    ...props,\n    breadcrumbs: getBreadcrumbs({\n      pathname: props.location.pathname,\n      routes,\n    }),\n  }));\n"],"names":["DEFAULT_MATCH_OPTIONS","exact","renderer","breadcrumb","match","createElement","getBreadcrumbs","routes","pathname","matches","segments","newPath","length","replace","startsWith","push","part","split","substr","reduce","previous","current","pathSection","breadcrumbMatch","some","matchOptions","path","Error","matchPath","withBreadcrumbs","withRouter","Component","props","location"],"mappings":";;;;;;;;;;;;;;;;;AAGA,IAAMA,wBAAwB,EAAEC,OAAO,IAAT,EAA9B;;;;AAIA,IAAMC,WAAW,SAAXA,QAAW,OAA2B;MAAxBC,UAAwB,QAAxBA,UAAwB;MAAZC,KAAY,QAAZA,KAAY;;MACtC,OAAOD,UAAP,KAAsB,UAA1B,EAAsC;WAC7BE,cAAcF,UAAd,EAA0B,EAAEC,YAAF,EAA1B,CAAP;;SAEKD,UAAP;CAJF;;AAOA,AAAO,IAAMG,iBAAiB,SAAjBA,cAAiB,QAA0B;MAAvBC,MAAuB,SAAvBA,MAAuB;MAAfC,QAAe,SAAfA,QAAe;;MAChDC,UAAU,EAAhB;MACMC,WAAW,EAAjB;;;MAGIC,UAAUH,SAASI,MAAT,GAAkB,CAAlB,GAAsBJ,SAASK,OAAT,CAAiB,KAAjB,EAAwB,EAAxB,CAAtB,GAAoDL,QAAlE;;SAEMG,QAAQC,MAAd,EAAsB;;QAEhBD,QAAQG,UAAR,CAAmB,MAAnB,CAAJ,EAAgC;eACrBC,IAAT,CAAcJ,OAAd;gBACU,EAAV;KAFF,MAGO;;UAECK,OAAOL,QAAQM,KAAR,CAAc,GAAd,EAAmB,CAAnB,EAAsB,CAAtB,CAAb;eACSF,IAAT,CAAcC,IAAd;;;gBAGUL,QAAQO,MAAR,CAAeF,KAAKJ,MAAL,GAAc,CAA7B,CAAV;;;;;;GAMDO,MAFH,CAEU,UAACC,QAAD,EAAWC,OAAX,EAAuB;;;;QAIvBC,cAAc,CAACD,OAAD,GAAW,GAAX,GAAoBD,QAApB,SAAgCC,OAApD;;QAEIE,wBAAJ;;WAEOC,IAAP,CAAY,iBAAwC;UAArCrB,UAAqC,SAArCA,UAAqC;UAAzBsB,YAAyB,SAAzBA,YAAyB;UAAXC,IAAW,SAAXA,IAAW;;UAC9C,OAAOvB,UAAP,KAAsB,WAAtB,IAAqC,CAACuB,IAA1C,EAAgD;cACxC,IAAIC,KAAJ,CAAU,iFAAV,CAAN;;;;UAIE,CAACxB,UAAL,EAAiB;eACR,KAAP;;;UAGIC,QAAQwB,UAAUN,WAAV,eAA6BG,gBAAgBzB,qBAA7C,IAAqE0B,UAArE,IAAd;;;;UAIItB,KAAJ,EAAW;0BACS;sBACJF,SAAS,EAAEC,sBAAF,EAAcC,YAAd,EAAT,CADI;oBAAA;;SAAlB;eAKO,IAAP;;;aAGK,KAAP;KAvBF;;;QA2BImB,eAAJ,EAAqB;cACXR,IAAR,CAAaQ,eAAb;;;WAGKD,gBAAgB,GAAhB,GAAsB,EAAtB,GAA2BA,WAAlC;GAzCJ,EA0CK,IA1CL;;SA4COb,OAAP;CAlEK;;AAqEP,AAAO,IAAMoB,kBAAkB,SAAlBA,eAAkB;SAAU;WAAaC,WAAW;aAC/DzB,cAAc0B,SAAd,eACKC,KADL;qBAEe1B,eAAe;oBAChB0B,MAAMC,QAAN,CAAezB,QADC;;SAAf;SAHgD;KAAX,CAAb;GAAV;CAAxB;;;;"}